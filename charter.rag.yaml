# =========================================================================
# Project Charter - RAG Chatbot System
# Charter Agent Framework v0.3.0
# =========================================================================
# 嵌入式产品知识库 Chatbot，支持产品推荐与比较
# =========================================================================

# 1. 项目概况 (Overview)
# -------------------------------------------------------------------------
meta:
  id: "PRJ-20260111-001"
  name: "rag-chatbot"
  owner: "Product Team"
  version: "1.0"

# 2. 核心目标 (Core Objectives)
# -------------------------------------------------------------------------
objective:
  problems:
    - "销售人员难以快速准确回答客户关于产品的复杂问题"
    - "潜在客户无法高效获取产品对比和推荐信息"
    - "产品知识分散，客户自助服务体验差"
  business_goals:
    - "提升销售效率 30%，减少人工咨询响应时间"
    - "提高客户自助服务满意度至 85%+"
    - "增加网站用户停留时间和转化率"

# 3. 干系人 (Stakeholders)
# -------------------------------------------------------------------------
stakeholders:
  users:
    - "产品销售团队：需要快速获取产品知识，回答客户问题"
    - "潜在客户：希望了解产品功能、对比方案、获取推荐"
    - "现有客户：需要产品使用指导和问题解答"

# 4. 项目范围 (Scope)
# -------------------------------------------------------------------------
scope:
  must_have:
    - "嵌入式 Chatbot Widget，可集成到现有产品网站"
    - "产品知识库 RAG 检索，基于向量数据库"
    - "产品推荐功能，根据用户需求推荐合适产品"
    - "产品比较功能，支持多产品横向对比"
    - "上下文感知对话，理解当前页面产品信息"
    - "对话历史管理，支持多轮对话"
  out_of_scope:
    - "用户身份认证（使用现有网站认证系统）"
    - "订单处理和支付功能"
    - "多语言支持（V1.0 仅支持中文）"
    - "语音交互"
    - "知识库自动更新和爬取"

# 5. 关键指标 (Metrics)
# -------------------------------------------------------------------------
metrics:
  performance:
    - "首次响应时间 < 2s"
    - "并发对话支持 >= 100"
    - "RAG 检索延迟 < 500ms"
  security:
    - "HTTPS 加密通信"
    - "敏感数据脱敏处理"
    - "API 访问频率限制"
  stability:
    - "系统可用性 >= 99.5%"
    - "异常自动恢复，优雅降级"
  usability:
    - "Widget 加载时间 < 1s"
    - "移动端自适应支持"
    - "无需用户培训即可使用"

# 6. 约束与依赖 (Constraints & Dependencies)
# -------------------------------------------------------------------------
constraints:
  resource:
    budget: "云服务月成本 < $500"
    timeline: "2026-02-28"
  technology_boundary:
    allowed:
      - "Python (FastAPI)"
      - "TypeScript/JavaScript (React)"
      - "PostgreSQL"
      - "Redis"
      - "OpenAI API / Compatible LLM"
      - "Pinecone / pgvector"
    forbidden:
      - "自建 LLM 训练"
      - "私有化部署专有数据库"

dependencies:
  external_systems:
    - "现有产品网站（提供嵌入入口）"
    - "产品数据库/API（获取产品信息）"
    - "用户认证系统（可选，SSO 集成）"
  resources:
    - "产品文档、FAQ、说明书等知识库原始资料"
    - "LLM API 密钥 (OpenAI/Claude/etc.)"
    - "向量数据库服务"

# 7. 风险 (Risks)
# -------------------------------------------------------------------------
risks:
  - "LLM API 成本可能超出预算 - 实施 Token 用量监控和限流策略"
  - "RAG 检索准确性不达预期 - 准备多种 Embedding 模型切换方案"
  - "产品知识库更新不及时 - 建立知识库版本管理和定期更新机制"
  - "高并发场景下性能下降 - 实施缓存策略和异步处理"

# 8. 交付物 (Deliverables)
# -------------------------------------------------------------------------
deliverables:
  mandatory:
    - "可运行的 Chatbot 后端 API 服务"
    - "可嵌入的前端 Widget 组件"
    - "知识库索引和管理工具"
    - "部署文档和集成指南"
    - "源代码"
    - "测试报告"

# 9. 环境配置 (Environments)
# -------------------------------------------------------------------------
environments:
  dev:
    database: "postgresql"
    vector_db: "pgvector"
    api_url: "http://localhost:8000"
    logging_level: "DEBUG"
    cache_enabled: false
    llm_provider: "openai"
  
  staging:
    database: "postgresql"
    vector_db: "pinecone"
    api_url: "https://staging-chat.example.com"
    logging_level: "INFO"
    cache_enabled: true
    llm_provider: "openai"
  
  production:
    database: "postgresql-ha"
    vector_db: "pinecone"
    api_url: "https://chat.example.com"
    logging_level: "ERROR"
    cache_enabled: true
    llm_provider: "openai"

# 10. 质量要求 (Quality Requirements)
# -------------------------------------------------------------------------
quality_requirements:
  code:
    test_coverage: "95%"
    type_coverage: "100%"
    complexity_limit: 10
    documentation: "required"
  
  performance:
    response_time_p95: "2000ms"
    throughput: "100rps"
    memory_limit: "1GB"
  
  security:
    vulnerability_scan: "required"
    dependency_audit: "required"
    secrets_detection: "required"

# 11. 语言配置 (Language Configuration)
# -------------------------------------------------------------------------
# 多语言项目：后端 Python + 前端 TypeScript
components:
  - name: "api-server"
    language_profile: python
    path: "apps/api"
    description: "RAG Chatbot 后端 API 服务"
  - name: "chat-widget"
    language_profile: typescript
    path: "apps/widget"
    description: "可嵌入的 Chatbot 前端组件"
  - name: "admin-dashboard"
    language_profile: typescript
    path: "apps/admin"
    description: "知识库管理后台（可选）"

# 12. 冻结状态 (Freeze Status)
# -------------------------------------------------------------------------
freeze:
  frozen: false
  checksum: ""
  frozen_at: ""
  frozen_by: ""
